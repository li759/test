
$a = (x[i+1] - xi) / hi$
$b = (xi - x[i]) / hi$
$y_{i} = (a * y_{i} + b * y[i+1] + ((a^3 - a) * M[i] + (b^3 - b) * M[i+1]) * hi**2 / 6)$


区间标准化：从 \($[x_i,x_{i+1}]$\) 到 $([0,h])$
给定原始区间  
$y(x)=ay_i+by_{i+1}+\frac{h_{i}^2}{6}$

![[Pasted image 20250730101928.png]]
![[Pasted image 20250730101947.png]]
![[Pasted image 20250730102119.png|395x80]]
![[Pasted image 20250730102522.png|396x97]]

![[Pasted image 20250730102153.png]]
$S(0)=y_0,\quad S(1)=y_1$
![[Pasted image 20250730102210.png]]
![[Pasted image 20250730102227.png]]
![[Pasted image 20250730102250.png]]
三次样条在区间 [xi​,xi+1​] 上的**Hermite插值形式**，可写成：
$S(x)=ay_i​+by_{i+1}​+\frac {h_i^2}{6}[(a^3-a)M_i+(b^3-b)M_{i+1}]$

$H(t)=a_0​+a_1​t+a_2​t^2+a_3​t^3，t∈[0,1].$
![[Pasted image 20250730102543.png]]
$H(0)=y_0​$左端点函数值；$H(1)=y_1$右端点函数值
$H^′(0)=m_0$​左端点一阶导；$H^′(1)=m_1​$右端点一阶导
$H^′(t)=a_1​+2a_2​t+3a_3​t^2.$
![[Pasted image 20250730102558.png]]
![[Pasted image 20250730102629.png]]


$\begin{cases}a_0 &= y_0 \\a_0 + a_1 +a_2 +a_3&= y_1\\a_1 &=  m_0 \\ a_1 +2a_2 +3a_3&=  m_1\end{cases}$

![[Pasted image 20250730102701.png]]
![[Pasted image 20250730102716.png]]
![[Pasted image 20250730102731.png]]
![[Pasted image 20250730102745.png]]


$\begin{bmatrix}1 & 0 & 0 & 0 \\1 & 1 & 1 & 1 \\0 & 1 & 0 & 0 \\0 & 1 & 2 & 3\end{bmatrix}\begin{bmatrix}a_0 \\ a_1 \\ a_2 \\ a_3\end{bmatrix}=\begin{bmatrix}y_0 \\ y_1 \\ m_0 \\ m_1\end{bmatrix}$

$\begin{aligned}a_0 &= y_0 \\a_1 &= m_0 \\a_2 &= 3(y_1 - y_0) - 2 m_0 - m_1 \\a_3 &= 2(y_0 - y_1) + m_0 + m_1\end{aligned}$

$\begin{aligned}h_{00}(t) &= 1 - 3t^2 + 2t^3 \\[4pt]h_{10}(t) &= t - 2t^2 + t^3 \\[4pt]h_{01}(t) &= 3t^2 - 2t^3 \\[4pt]h_{11}(t) &= -t^2 + t^3\end{aligned}$

x(1，12) 
$$
\begin{bmatrix}
-0.010261578722750226 & 0.011662440639114908 &
0.054250333995079725&
0.26804783814876787&
0.4409028016492775&
0.7418167931700745&
1.4032904523987006&
1.7258107558171707&
2.7207051030440863&
3.894103481653225&
5.130709920525158&
6.181068078187404
\end{bmatrix}
$$

y(1，12) 
$$
\begin{bmatrix}
1.4378672027932817&
2.4365906229732506&
3.6849145335284152&
4.907370697906917&
5.3764644281191245&
6.102409465523916&
7.160799598091548&
7.517949384667596&
8.27064447467325&
8.67467998262617&
8.570214859499773&
8.007515147559529
\end{bmatrix}
$$

h = diff(x)--x相邻两点差（1，11)  
$$
\begin{bmatrix}
0.021924019361865135&
0.042587893355964815&
0.21379750415368814&
0.1728549635005096&
0.30091399152079706&
0.6614736592286261&
0.32252030341847004&
0.9948943472269156&
1.1733983786091389&
1.2366064388719327&
1.050358157662246
\end{bmatrix}
$$

A:
A[i, i-1] = h[i-1]

A[i, i] = 2 * (h[i-1] + h[i])
A[i, i+1] = h[i]
$$
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0.02192402 & 0.12902383 & 0.04258789 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0.04258789 & 0.5127708 & 0.2137975 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0.2137975 & 0.77330494 & 0.17285496 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0.17285496 & 0.94753791 & 0.30091399 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0.30091399 & 1.9247753 & 0.66147366 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0.66147366 & 1.96798793 & 0.3225203 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0.3225203 & 2.6348293 & 0.99489435 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.99489435 & 4.33658545 & 1.17339838 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1.17339838 & 4.82000963 & 1.23660644 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1.23660644 & 4.57392919 & 1.05035816 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$

rhs
rhs[i] = 6 * ((y[i+1] - y[i])/h[i] - (y[i] - y[i-1])/h[i-1])
$$
\mathbf{rhs} =
\begin{bmatrix}
0.0 &
-97.45283077622224 &
-141.56331570791758 &
-18.02413699079313 &
-1.8079963167011774 &
-4.8745084818620095 &
-2.956063885032621 &
-2.104882026839995 &
-2.473370733398127 &
-2.5728396930041395 &
-2.7074669516475027 &
0.0
\end{bmatrix}
$$

M= np.linalg.solve(A, rhs)
$$
\mathbf{M} = 
\begin{bmatrix}
0.0 & -676.5541757729515 & -238.5941661541006 & 44.87340337866419 & -9.916545197826805 & -0.5592438803573107 & -1.2306801102416391 & -0.5090383163355949 & -0.3686156564616548 & -0.3139582460651033 & -0.5070529221443058 & 0.0
\end{bmatrix}
$$
